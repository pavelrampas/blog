function loadComments(){fetch(apiRequestUrl(),{method:"GET",headers:{Authorization:"d58e3582afa99040e27b92b13c8f2280"},credentials:"include"}).then(e=>e.json()).then(e=>{let t=document.getElementById("comments");if(t&&t.classList.remove("hide"),!t){console.error("Comments section not found.");return}if(t.innerHTML='<h3>Komentáře</h3><div id="comment-list"><p>Zatím tu není žádný komentář.</p></div><form action="" method="post" id="comment-form"><h3>Nový komentář</h3><div class="form-group"><label for="name">Jméno*</label><br><input type="text" id="name" name="name" required></div><div class="form-group"><label for="email">E-mail* (nebude zveřejněn)</label><br><input type="email" id="email" name="email" required></div><div class="form-group"><label for="comment">Komentář*</label><br><textarea id="comment" name="comment" rows="4" required></textarea></div><input type="hidden" name="post-id" id="post-id" value="1000"><input type="hidden" name="email-check" id="email-check" value=""><input type="hidden" name="time-check" id="time-check" value="'+new Date().getTime()+'"><div class="form-group"><button type="submit">Odeslat komentář</button></div></form>',addCommentEventListener(),e.errors){alert(e.errors[0].detail);return}if(e.data.length>0){let n=document.getElementById("comment-list");for(let m of(n.innerHTML="",e.data)){let a=createCommentElement(m);n.appendChild(a)}}}).catch(e=>console.error("Error loading comments:",e))}function addComment(){let e=document.getElementById("comment").value.trim(),t=document.getElementById("name").value.trim(),n=document.getElementById("email").value.trim(),m=document.getElementById("email-check").value.trim(),a=document.getElementById("time-check").value.trim();if(""!==m){alert("Antispamová kontrola selhala. Zkuste to prosím znovu.");return}let i=new Date().getTime();if(i-parseInt(a)<5e3){alert("Antispamová kontrola selhala. Zkuste to prosím znovu.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)){alert("Zadejte prosím platnou e-mailovou adresu.");return}if(e.length<5||e.length>500){alert("Komentář musí mít alespoň 5 znaků a maximálně 500 znaků.");return}if(t.length<3||t.length>50){alert("Jméno musí mít alespoň 3 znaky a maximálně 50 znaků.");return}fetch(apiRequestUrl(),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"d58e3582afa99040e27b92b13c8f2280"},credentials:"include",body:JSON.stringify({comment:e,name:t,email:n,email_check:m,time_check:a})}).then(e=>e.json()).then(e=>{if(e.errors){alert(e.errors[0].detail);return}document.getElementById("comment").value="",document.getElementById("name").value="",document.getElementById("email").value="";let t=document.getElementById("comment-list"),n=createCommentElement(e.data[0]);t.appendChild(n)}).catch(e=>console.error("Error adding comment:",e))}function addCommentEventListener(){document.getElementById("comment-form").addEventListener("submit",function(e){e.preventDefault();let t=this.querySelector('button[type="submit"]');t.disabled=!0,t.textContent="Odesílání...",addComment(),t.disabled=!1,t.textContent="Odeslat komentář"})}function apiRequestUrl(){let e=document.getElementById("comments");return"https://blog.pavelrampas.cz/api/v1/comments/index.php?article="+e.dataset.articleId}function createCommentElement(e){let t=document.createElement("div");return t.className="comment",t.id="comment-"+e.id,t.innerHTML='<p class="comment-name"><strong>'+e.attributes.name+'</strong><a href="#comment-'+e.id+'" class="comment-date">'+new Date(e.attributes.created).toLocaleString(void 0,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",hour12:!1,minute:"2-digit"})+"</a></p><p>"+e.attributes.comment+"</p>",t}loadComments();